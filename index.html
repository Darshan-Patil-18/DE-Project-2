<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sal College Lost & Found System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .highlight { background-color: #fef08a; padding: 2px 4px; border-radius: 2px; }
        .timer-warning { color: #ef4444; font-weight: bold; }
        .success-animation { animation: bounce 0.6s ease-in-out; }
        @keyframes bounce { 0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); } 40%, 43% { transform: translate3d(0,-30px,0); } 70% { transform: translate3d(0,-15px,0); } 90% { transform: translate3d(0,-4px,0); } }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Navigation Bar (Hidden initially) -->
    <nav id="navbar" class="bg-white shadow-lg hidden">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-search text-2xl text-blue-600"></i>
                    <h1 class="text-xl font-bold text-gray-800">Sal College Lost & Found</h1>
                </div>
                <div class="flex items-center space-x-6">
                    <button onclick="showPage('home')" class="text-gray-600 hover:text-blue-600 transition-colors">
                        <i class="fas fa-home mr-2"></i>Home
                    </button>
                    <button onclick="showPage('report-found')" class="text-gray-600 hover:text-blue-600 transition-colors">
                        <i class="fas fa-plus-circle mr-2"></i>Report Found
                    </button>
                    <button onclick="showPage('report-lost')" class="text-gray-600 hover:text-blue-600 transition-colors">
                        <i class="fas fa-exclamation-circle mr-2"></i>Report Lost
                    </button>
                    <button onclick="showPage('search')" class="text-gray-600 hover:text-blue-600 transition-colors">
                        <i class="fas fa-search mr-2"></i>Search
                    </button>
                    <div class="relative">
                        <button onclick="toggleProfileMenu()" class="flex items-center text-gray-600 hover:text-blue-600 transition-colors">
                            <i class="fas fa-user-circle text-2xl"></i>
                            <i class="fas fa-chevron-down ml-1"></i>
                        </button>
                        <div id="profileMenu" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg hidden z-50">
                            <button onclick="showPage('profile')" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100">
                                <i class="fas fa-user mr-2"></i>My Profile
                            </button>
                            <button onclick="logout()" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100">
                                <i class="fas fa-sign-out-alt mr-2"></i>Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container mx-auto px-4 py-8">
        <!-- Enrollment Verification Page -->
        <div id="enrollment-page" class="fade-in">
            <div class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-8">
                <div class="text-center mb-8">
                    <i class="fas fa-graduation-cap text-5xl text-blue-600 mb-4"></i>
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">Sal College Lost & Found</h1>
                    <p class="text-gray-600">Enter your enrollment number to continue</p>
                </div>
                
                <form onsubmit="verifyEnrollment(event)">
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Enrollment Number</label>
                        <input type="text" id="enrollmentInput" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., SEC202401" required>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors">
                        Continue
                    </button>
                </form>
                
                <div id="enrollmentError" class="mt-4 text-red-600 text-sm hidden"></div>
            </div>
        </div>

        <!-- Home Dashboard -->
        <div id="home-page" class="fade-in hidden">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Welcome to Lost & Found</h1>
                <p class="text-gray-600">Help your fellow students find their lost items</p>
            </div>
            
            <!-- Statistics Cards -->
            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow-lg p-6 text-center">
                    <i class="fas fa-search text-3xl text-blue-600 mb-4"></i>
                    <h3 class="text-2xl font-bold text-gray-800" id="foundThisMonth">0</h3>
                    <p class="text-gray-600">Items Found This Month</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6 text-center">
                    <i class="fas fa-handshake text-3xl text-green-600 mb-4"></i>
                    <h3 class="text-2xl font-bold text-gray-800" id="itemsReturned">0</h3>
                    <p class="text-gray-600">Items Returned</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6 text-center">
                    <i class="fas fa-exclamation-triangle text-3xl text-orange-600 mb-4"></i>
                    <h3 class="text-2xl font-bold text-gray-800" id="activeLostReports">0</h3>
                    <p class="text-gray-600">Active Lost Reports</p>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="grid md:grid-cols-3 gap-6">
                <button onclick="showPage('report-found')" class="bg-white rounded-lg shadow-lg p-6 text-center hover:shadow-xl transition-shadow">
                    <i class="fas fa-plus-circle text-4xl text-green-600 mb-4"></i>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Report Found Item</h3>
                    <p class="text-gray-600">Found something? Help return it to its owner</p>
                </button>
                <button onclick="showPage('report-lost')" class="bg-white rounded-lg shadow-lg p-6 text-center hover:shadow-xl transition-shadow">
                    <i class="fas fa-exclamation-circle text-4xl text-red-600 mb-4"></i>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Report Lost Item</h3>
                    <p class="text-gray-600">Lost something? Let others know to help you find it</p>
                </button>
                <button onclick="showPage('search')" class="bg-white rounded-lg shadow-lg p-6 text-center hover:shadow-xl transition-shadow">
                    <i class="fas fa-search text-4xl text-blue-600 mb-4"></i>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Search Database</h3>
                    <p class="text-gray-600">Search through found and lost items</p>
                </button>
            </div>
        </div>

        <!-- Report Found Item Page -->
        <div id="report-found-page" class="fade-in hidden">
            <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-8">
                <div class="text-center mb-8">
                    <i class="fas fa-plus-circle text-5xl text-green-600 mb-4"></i>
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">Report Found Item</h1>
                    <p class="text-gray-600">Help return a found item to its owner</p>
                </div>
                
                <form onsubmit="submitFoundItem(event)">
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Category</label>
                            <select id="foundCategory" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                <option value="">Select Category</option>
                                <option value="Wallet">Wallet</option>
                                <option value="Keys">Keys</option>
                                <option value="ID Card">ID Card</option>
                                <option value="Books">Books</option>
                                <option value="Notes">Notes</option>
                                <option value="Earbuds/Headphones">Earbuds/Headphones</option>
                                <option value="Charger">Charger</option>
                                <option value="Water Bottle">Water Bottle</option>
                                <option value="Bag">Bag</option>
                                <option value="Laptop">Laptop</option>
                                <option value="Mobile Phone">Mobile Phone</option>
                                <option value="Others">Others</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Date Found</label>
                            <input type="date" id="foundDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Item Name</label>
                        <input type="text" id="foundItemName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Black Leather Wallet" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Found Location</label>
                        <input type="text" id="foundLocation" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Library 2nd Floor" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Description</label>
                        <textarea id="foundDescription" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Describe the item in detail..."></textarea>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Upload Image (Optional)</label>
                        <input type="file" id="foundImage" accept="image/*" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <button type="submit" class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors">
                        Submit Found Item Report
                    </button>
                </form>
            </div>
        </div>

        <!-- Report Lost Item Page -->
        <div id="report-lost-page" class="fade-in hidden">
            <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-8">
                <div class="text-center mb-8">
                    <i class="fas fa-exclamation-circle text-5xl text-red-600 mb-4"></i>
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">Report Lost Item</h1>
                    <p class="text-gray-600">Let others know about your lost item</p>
                </div>
                
                <form onsubmit="submitLostItem(event)">
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Category</label>
                            <select id="lostCategory" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                <option value="">Select Category</option>
                                <option value="Wallet">Wallet</option>
                                <option value="Keys">Keys</option>
                                <option value="ID Card">ID Card</option>
                                <option value="Books">Books</option>
                                <option value="Notes">Notes</option>
                                <option value="Earbuds/Headphones">Earbuds/Headphones</option>
                                <option value="Charger">Charger</option>
                                <option value="Water Bottle">Water Bottle</option>
                                <option value="Bag">Bag</option>
                                <option value="Laptop">Laptop</option>
                                <option value="Mobile Phone">Mobile Phone</option>
                                <option value="Others">Others</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Date Lost</label>
                            <input type="date" id="lostDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Item Name</label>
                        <input type="text" id="lostItemName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Black Leather Wallet" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Last Seen Location</label>
                        <input type="text" id="lostLocation" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Cafeteria" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Description</label>
                        <textarea id="lostDescription" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Describe the item in detail..."></textarea>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Upload Image (Optional)</label>
                        <input type="file" id="lostImage" accept="image/*" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <button type="submit" class="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors">
                        Submit Lost Item Report
                    </button>
                </form>
            </div>
        </div>

        <!-- Search Page -->
        <div id="search-page" class="fade-in hidden">
            <div class="max-w-6xl mx-auto">
                <div class="text-center mb-8">
                    <i class="fas fa-search text-5xl text-blue-600 mb-4"></i>
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">Search Database</h1>
                    <p class="text-gray-600">Find lost and found items</p>
                </div>
                
                <!-- Search Filters -->
                <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                    <div class="flex flex-wrap gap-4 mb-4">
                        <div class="flex border-b border-gray-200">
                            <button onclick="switchSearchTab('found')" id="searchFoundTab" class="px-4 py-2 text-green-600 border-b-2 border-green-600 font-medium">
                                <i class="fas fa-search mr-2"></i>Found Items
                            </button>
                            <button onclick="switchSearchTab('lost')" id="searchLostTab" class="px-4 py-2 text-gray-500 hover:text-gray-700 font-medium">
                                <i class="fas fa-exclamation-circle mr-2"></i>Lost Items
                            </button>
                        </div>
                        
                        <select id="searchCategory" onchange="performSearch()" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">All Categories</option>
                            <option value="Wallet">Wallet</option>
                            <option value="Keys">Keys</option>
                            <option value="ID Card">ID Card</option>
                            <option value="Books">Books</option>
                            <option value="Notes">Notes</option>
                            <option value="Earbuds/Headphones">Earbuds/Headphones</option>
                            <option value="Charger">Charger</option>
                            <option value="Water Bottle">Water Bottle</option>
                            <option value="Bag">Bag</option>
                            <option value="Laptop">Laptop</option>
                            <option value="Mobile Phone">Mobile Phone</option>
                            <option value="Others">Others</option>
                        </select>
                    </div>
                    
                    <input type="text" id="searchInput" oninput="performSearch()" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Search by item name, description, or location...">
                </div>
                
                <!-- Search Results -->
                <div id="searchResults" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Results will be populated here -->
                </div>
                
                <div id="noResults" class="text-center py-12 hidden">
                    <i class="fas fa-search text-6xl text-gray-300 mb-4"></i>
                    <h3 class="text-xl font-bold text-gray-500 mb-2">No items found</h3>
                    <p class="text-gray-400">Try adjusting your search criteria</p>
                </div>
            </div>
        </div>

        <!-- Profile Page -->
        <div id="profile-page" class="fade-in hidden">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-8">
                    <i class="fas fa-user-circle text-5xl text-blue-600 mb-4"></i>
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">My Profile</h1>
                    <p class="text-gray-600" id="profileInfo">Welcome back!</p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- My Found Items -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-search text-green-600 mr-2"></i>
                            My Found Items
                        </h2>
                        <div id="myFoundItems" class="space-y-4">
                            <!-- Found items will be populated here -->
                        </div>
                    </div>
                    
                    <!-- My Lost Items -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-exclamation-circle text-red-600 mr-2"></i>
                            My Lost Items
                        </h2>
                        <div id="myLostItems" class="space-y-4">
                            <!-- Lost items will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-8 max-w-md mx-4 text-center success-animation">
            <i class="fas fa-check-circle text-6xl text-green-600 mb-4"></i>
            <h2 class="text-2xl font-bold text-gray-800 mb-2" id="successTitle">Success!</h2>
            <p class="text-gray-600 mb-6" id="successMessage">Operation completed successfully.</p>
            <button onclick="closeSuccessModal()" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition-colors">
                Continue
            </button>
        </div>
    </div>

    <script>
        // Database simulation using localStorage
        const DB = {
            validEnrollments: [
                { enrollment: '231130146011', college: 'Sal College of Engineering' },
                { enrollment: '231130146002', college: 'Sal College of Engineering' },
                { enrollment: '231130146003', college: 'Sal College of Engineering' },
                { enrollment: '241130146011', college: 'Sal Engineering and Technical Institute' },
                { enrollment: '241130146012', college: 'Sal Engineering and Technical Institute' },
                { enrollment: '241130146013', college: 'Sal Engineering and Technical Institute' },
                { enrollment: '251130146011', college: 'Saliter' },
                { enrollment: '251130146012', college: 'Saliter' },
                { enrollment: '251130146013', college: 'Saliter' },
                { enrollment: '251130146014', college: 'Saliter' }
            ],
            
            getUsers: () => JSON.parse(localStorage.getItem('users') || '[]'),
            saveUsers: (users) => localStorage.setItem('users', JSON.stringify(users)),
            
            getFoundItems: () => JSON.parse(localStorage.getItem('foundItems') || '[]'),
            saveFoundItems: (items) => localStorage.setItem('foundItems', JSON.stringify(items)),
            
            getLostItems: () => JSON.parse(localStorage.getItem('lostItems') || '[]'),
            saveLostItems: (items) => localStorage.setItem('lostItems', JSON.stringify(items))
        };

        // Global variables
        let currentUser = null;
        let currentSearchType = 'found';

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('foundDate').value = today;
            document.getElementById('lostDate').value = today;
            
            // Check if user is already logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showPage('home');
            }
        });

        // Page navigation
        function showPage(pageId) {
            // Hide all pages
            const pages = ['enrollment', 'home', 'report-found', 'report-lost', 'search', 'profile'];
            pages.forEach(page => {
                const element = document.getElementById(page + '-page');
                if (element) element.classList.add('hidden');
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageId + '-page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
                targetPage.classList.add('fade-in');
            }
            
            // Show/hide navbar
            const navbar = document.getElementById('navbar');
            if (['home', 'report-found', 'report-lost', 'search', 'profile'].includes(pageId)) {
                navbar.classList.remove('hidden');
                if (pageId === 'home') updateDashboardStats();
                if (pageId === 'profile') loadProfileData();
                if (pageId === 'search') performSearch();
            } else {
                navbar.classList.add('hidden');
            }
            
            // Hide profile menu
            document.getElementById('profileMenu').classList.add('hidden');
        }

        // Enrollment verification
        function verifyEnrollment(event) {
            event.preventDefault();
            const enrollment = document.getElementById('enrollmentInput').value.trim().toUpperCase();
            const errorDiv = document.getElementById('enrollmentError');
            
            const validEnrollment = DB.validEnrollments.find(e => e.enrollment === enrollment);
            
            if (validEnrollment) {
                // Create a user automatically based on enrollment
                const users = DB.getUsers();
                let user = users.find(u => u.enrollment === enrollment);
                
                if (!user) {
                    // Create new user automatically
                    user = {
                        id: Date.now().toString(),
                        enrollment: enrollment,
                        college: validEnrollment.college,
                        name: "Student " + enrollment, // Default name
                        registeredAt: new Date().toISOString()
                    };
                    
                    users.push(user);
                    DB.saveUsers(users);
                }
                
                // Log in user
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                showPage('home');
                errorDiv.classList.add('hidden');
            } else {
                errorDiv.textContent = 'Enrollment not found. Please check your number or contact administration.';
                errorDiv.classList.remove('hidden');
            }
        }

        // Submit found item
        function submitFoundItem(event) {
            event.preventDefault();
            
            const itemData = {
                id: Date.now().toString(),
                userId: currentUser.id,
                category: document.getElementById('foundCategory').value,
                itemName: document.getElementById('foundItemName').value.trim(),
                location: document.getElementById('foundLocation').value.trim(),
                date: document.getElementById('foundDate').value,
                description: document.getElementById('foundDescription').value.trim(),
                image: null, // In real app, would handle file upload
                submittedAt: new Date().toISOString(),
                isReturned: false
            };
            
            // Handle image upload (simplified for demo)
            const imageFile = document.getElementById('foundImage').files[0];
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    itemData.image = e.target.result;
                    saveFoundItem(itemData);
                };
                reader.readAsDataURL(imageFile);
            } else {
                saveFoundItem(itemData);
            }
        }

        function saveFoundItem(itemData) {
            const foundItems = DB.getFoundItems();
            foundItems.push(itemData);
            DB.saveFoundItems(foundItems);
            
            // Reset form
            document.getElementById('foundCategory').value = '';
            document.getElementById('foundItemName').value = '';
            document.getElementById('foundLocation').value = '';
            document.getElementById('foundDescription').value = '';
            document.getElementById('foundImage').value = '';
            
            showSuccessModal('Item Reported!', 'Your found item has been added to the database. Other students can now search for it.');
        }

        // Submit lost item
        function submitLostItem(event) {
            event.preventDefault();
            
            const itemData = {
                id: Date.now().toString(),
                userId: currentUser.id,
                category: document.getElementById('lostCategory').value,
                itemName: document.getElementById('lostItemName').value.trim(),
                location: document.getElementById('lostLocation').value.trim(),
                date: document.getElementById('lostDate').value,
                description: document.getElementById('lostDescription').value.trim(),
                image: null,
                submittedAt: new Date().toISOString()
            };
            
            // Handle image upload (simplified for demo)
            const imageFile = document.getElementById('lostImage').files[0];
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    itemData.image = e.target.result;
                    saveLostItem(itemData);
                };
                reader.readAsDataURL(imageFile);
            } else {
                saveLostItem(itemData);
            }
        }

        function saveLostItem(itemData) {
            const lostItems = DB.getLostItems();
            lostItems.push(itemData);
            DB.saveLostItems(lostItems);
            
            // Reset form
            document.getElementById('lostCategory').value = '';
            document.getElementById('lostItemName').value = '';
            document.getElementById('lostLocation').value = '';
            document.getElementById('lostDescription').value = '';
            document.getElementById('lostImage').value = '';
            
            showSuccessModal('Item Reported!', 'Your lost item has been added to the database. We\'ll help you find it!');
        }

        // Search functionality
        function switchSearchTab(type) {
            currentSearchType = type;
            
            document.getElementById('searchFoundTab').className = type === 'found'
                ? 'px-4 py-2 text-green-600 border-b-2 border-green-600 font-medium'
                : 'px-4 py-2 text-gray-500 hover:text-gray-700 font-medium';
            
            document.getElementById('searchLostTab').className = type === 'lost'
                ? 'px-4 py-2 text-red-600 border-b-2 border-red-600 font-medium'
                : 'px-4 py-2 text-gray-500 hover:text-gray-700 font-medium';
            
            performSearch();
        }

        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('searchCategory').value;
            
            const items = currentSearchType === 'found' 
                ? DB.getFoundItems().filter(item => !item.isReturned)
                : DB.getLostItems();
            
            let filteredItems = items;
            
            // Filter by category
            if (category) {
                filteredItems = filteredItems.filter(item => item.category === category);
            }
            
            // Filter by search term
            if (searchTerm) {
                filteredItems = filteredItems.filter(item => 
                    item.itemName.toLowerCase().includes(searchTerm) ||
                    item.description.toLowerCase().includes(searchTerm) ||
                    item.location.toLowerCase().includes(searchTerm)
                );
            }
            
            displaySearchResults(filteredItems, searchTerm);
        }

        function displaySearchResults(items, searchTerm) {
            const resultsContainer = document.getElementById('searchResults');
            const noResultsDiv = document.getElementById('noResults');
            
            if (items.length === 0) {
                resultsContainer.innerHTML = '';
                noResultsDiv.classList.remove('hidden');
                return;
            }
            
            noResultsDiv.classList.add('hidden');
            
            resultsContainer.innerHTML = items.map(item => {
                const users = DB.getUsers();
                const user = users.find(u => u.id === item.userId);
                const userName = user ? user.name : 'Unknown User';
                
                // Highlight search terms
                const highlightText = (text) => {
                    if (!searchTerm) return text;
                    const regex = new RegExp(`(${searchTerm})`, 'gi');
                    return text.replace(regex, '<span class="highlight">$1</span>');
                };
                
                const cardColor = currentSearchType === 'found' ? 'border-green-500' : 'border-red-500';
                const iconColor = currentSearchType === 'found' ? 'text-green-600' : 'text-red-600';
                const icon = currentSearchType === 'found' ? 'fa-search' : 'fa-exclamation-circle';
                
                return `
                    <div class="bg-white rounded-lg shadow-lg border-l-4 ${cardColor} p-6">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fas ${icon} ${iconColor} text-xl mr-3"></i>
                                <div>
                                    <h3 class="font-bold text-gray-800">${highlightText(item.itemName)}</h3>
                                    <span class="text-sm text-gray-500">${item.category}</span>
                                </div>
                            </div>
                            <span class="text-xs text-gray-400">${new Date(item.date).toLocaleDateString()}</span>
                        </div>
                        
                        ${item.image ? `<img src="${item.image}" alt="Item image" class="w-full h-32 object-cover rounded-md mb-4">` : ''}
                        
                        <div class="space-y-2 text-sm">
                            <p><strong>Location:</strong> ${highlightText(item.location)}</p>
                            ${item.description ? `<p><strong>Description:</strong> ${highlightText(item.description)}</p>` : ''}
                            <p><strong>Reported by:</strong> ${userName}</p>
                        </div>
                        
                        <div class="mt-4 pt-4 border-t border-gray-200">
                            <p class="text-xs text-gray-500">
                                ${currentSearchType === 'found' ? 'Found' : 'Lost'} on ${new Date(item.date).toLocaleDateString()}
                            </p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Profile management
        function loadProfileData() {
            if (!currentUser) return;
            
            document.getElementById('profileInfo').textContent = 
                `${currentUser.name} â€¢ ${currentUser.enrollment} â€¢ ${currentUser.college}`;
            
            // Load user's found items
            const foundItems = DB.getFoundItems().filter(item => item.userId === currentUser.id);
            const myFoundItemsContainer = document.getElementById('myFoundItems');
            
            if (foundItems.length === 0) {
                myFoundItemsContainer.innerHTML = '<p class="text-gray-500 text-center py-4">No found items reported yet.</p>';
            } else {
                myFoundItemsContainer.innerHTML = foundItems.map(item => `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-semibold text-gray-800">${item.itemName}</h4>
                            <span class="text-xs text-gray-500">${new Date(item.date).toLocaleDateString()}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">${item.category} â€¢ ${item.location}</p>
                        ${item.description ? `<p class="text-sm text-gray-500 mb-3">${item.description}</p>` : ''}
                        
                        ${!item.isReturned ? `
                            <button onclick="markAsReturned('${item.id}')" class="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors">
                                Mark as Returned
                            </button>
                        ` : `
                            <span class="text-green-600 text-sm font-medium">
                                <i class="fas fa-check-circle mr-1"></i>Returned
                            </span>
                        `}
                    </div>
                `).join('');
            }
            
            // Load user's lost items
            const lostItems = DB.getLostItems().filter(item => item.userId === currentUser.id);
            const myLostItemsContainer = document.getElementById('myLostItems');
            
            if (lostItems.length === 0) {
                myLostItemsContainer.innerHTML = '<p class="text-gray-500 text-center py-4">No lost items reported yet.</p>';
            } else {
                myLostItemsContainer.innerHTML = lostItems.map(item => `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-semibold text-gray-800">${item.itemName}</h4>
                            <span class="text-xs text-gray-500">${new Date(item.date).toLocaleDateString()}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">${item.category} â€¢ ${item.location}</p>
                        ${item.description ? `<p class="text-sm text-gray-500">${item.description}</p>` : ''}
                    </div>
                `).join('');
            }
        }

        // Mark item as returned
        function markAsReturned(itemId) {
            const foundItems = DB.getFoundItems();
            const itemIndex = foundItems.findIndex(item => item.id === itemId);
            
            if (itemIndex !== -1) {
                foundItems[itemIndex].isReturned = true;
                DB.saveFoundItems(foundItems);
                
                showSuccessModal('Woahhh! ðŸŽ‰', 'You did a great job helping a fellow student!');
                loadProfileData(); // Refresh profile data
            }
        }

        // Update dashboard statistics
        function updateDashboardStats() {
            const foundItems = DB.getFoundItems();
            const lostItems = DB.getLostItems();
            
            // Items found this month
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const foundThisMonth = foundItems.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate.getMonth() === currentMonth && itemDate.getFullYear() === currentYear;
            }).length;
            
            // Items returned
            const itemsReturned = foundItems.filter(item => item.isReturned).length;
            
            // Active lost reports
            const activeLostReports = lostItems.length;
            
            document.getElementById('foundThisMonth').textContent = foundThisMonth;
            document.getElementById('itemsReturned').textContent = itemsReturned;
            document.getElementById('activeLostReports').textContent = activeLostReports;
        }

        // Profile menu toggle
        function toggleProfileMenu() {
            const menu = document.getElementById('profileMenu');
            menu.classList.toggle('hidden');
        }

        // Logout
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            showPage('enrollment');
        }

        // Success modal
        function showSuccessModal(title, message) {
            document.getElementById('successTitle').textContent = title;
            document.getElementById('successMessage').textContent = message;
            document.getElementById('successModal').classList.remove('hidden');
        }

        function closeSuccessModal() {
            document.getElementById('successModal').classList.add('hidden');
            showPage('home');
        }

        // Close profile menu when clicking outside
        document.addEventListener('click', function(event) {
            const profileMenu = document.getElementById('profileMenu');
            const profileButton = event.target.closest('button');
            
            if (!profileButton || !profileButton.onclick || profileButton.onclick.toString().indexOf('toggleProfileMenu') === -1) {
                profileMenu.classList.add('hidden');
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97378c9c10980330',t:'MTc1NTkyMDAxNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
